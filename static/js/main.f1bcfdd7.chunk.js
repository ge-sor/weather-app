(this["webpackJsonpweather-app"]=this["webpackJsonpweather-app"]||[]).push([[0],{18:function(t,e,n){},24:function(t,e,n){},25:function(t,e,n){"use strict";n.r(e);var c=n(0),a=n.n(c),o=n(6),i=n.n(o),r=(n(18),n(2)),s=n(3),d="ADD_ITEM",l="REMOVE_ITEM",u=function(t){return{type:d,payload:t}},p=n(26),j=n(1);function m(t){var e=t.isOpen,n=t.onClose;return Object(j.jsx)("section",{className:"popup ".concat(e&&"popup_opened"),children:Object(j.jsxs)("div",{className:"popup__container",children:[Object(j.jsx)("h2",{children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0433\u043e\u0440\u043e\u0434\u0430"}),Object(j.jsx)("button",{type:"button",className:"button popup__close-btn",onClick:n})]})})}var h="https://api.openweathermap.org/data/2.5",b=function(t){return t.ok?t.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(t.status))},O="e8589dd59b877616c63ff3a5270d69ff";function f(t){var e=t.onClose,n=t.card,a=Object(c.useState)({}),o=Object(r.a)(a,2),i=o[0],s=o[1];return Object(c.useEffect)((function(){var t,e;n&&(t=n.coord.lon,e=n.coord.lat,fetch("".concat(h,"/onecall?lat=").concat(e,"&lon=").concat(t,"&exclude=hourly,minutely&appid=").concat(O,"&units=metric&lang=ru")).then(b)).then((function(t){var e={temp:"".concat(Math.floor(t.daily[1].temp.day),"\xb0C"),icon:"http://openweathermap.org/img/wn/".concat(t.daily[1].weather[0].icon,".png"),weather:t.daily[1].weather.description},n=new Date(1e3*t.daily[0].sunrise),c=new Date(1e3*t.daily[0].sunset),a=new Date(1e3*t.daily[1].sunrise),o=new Date(1e3*t.daily[1].sunset),r=7.5*-n.getHours()+180,d=7.5*-c.getHours()+180,l=7.5*-a.getHours()+180,u=7.5*-o.getHours()+180;e.dusk=c.toLocaleTimeString([],{timeZone:t.timezone,hour:"2-digit",minute:"2-digit"}),e.dawn=n.toLocaleTimeString([],{timeZone:t.timezone,hour:"2-digit",minute:"2-digit"}),e.duskTomorrow=o.toLocaleTimeString([],{timeZone:t.timezone,hour:"2-digit",minute:"2-digit"}),e.dawnTomorrow=a.toLocaleTimeString([],{timeZone:t.timezone,hour:"2-digit",minute:"2-digit"}),s(e);var p=40,j=document.getElementById("canvas").getContext("2d"),m=document.getElementById("canvas2").getContext("2d");function h(t){t.clearRect(0,0,180,100),t.beginPath(),t.arc(60,60,p,0,Math.PI,!0),t.stroke()}function b(t,e,n){var c=50+p*Math.cos(-e*Math.PI/180),a=50+p*Math.sin(-e*Math.PI/180),o=50+p*Math.cos(-n*Math.PI/180),i=50+p*Math.sin(-n*Math.PI/180),r=new Image;r.src="http://openweathermap.org/img/wn/01d.png",r.onload=function(){t.drawImage(r,c,a,20,20)};var s=new Image;s.src="http://openweathermap.org/img/wn/01n.png",s.onload=function(){t.drawImage(s,o,i,20,20)}}function O(t,e,n){var c=60+p*Math.cos(-t*Math.PI/180),a=60+p*Math.sin(-t*Math.PI/180);n.beginPath(),n.arc(c,a,3,0,2*Math.PI),n.fill(),n.font="10px",n.fillText(e,c+10,a)}b(j,r,d),b(m,l,u),h(j),O(r,i.dawn,j),O(d,i.dusk,j),h(m),O(l,i.dawnTomorrow,m),O(u,i.duskTomorrow,m)}))}),[n,i.dawn,i.dawnTomorrow,i.dusk,i.duskTomorrow]),Object(j.jsx)("section",{className:"popup ".concat(n&&"popup_opened"),children:Object(j.jsxs)("div",{className:"popup__container popup__container_place",children:[Object(j.jsx)("h2",{className:"card__text",children:null===n||void 0===n?void 0:n.title}),Object(j.jsx)("h3",{children:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f"}),Object(j.jsxs)("div",{className:"card__container",children:[Object(j.jsx)("p",{children:null===n||void 0===n?void 0:n.temp}),Object(j.jsx)("img",{className:"card__image",src:null===n||void 0===n?void 0:n.icon,alt:null===n||void 0===n?void 0:n.weather}),Object(j.jsxs)("p",{className:"card__time-text",children:["\u0420\u0430\u0441\u0441\u0432\u0435\u0442: ",i.dawn]}),Object(j.jsxs)("p",{className:"card__time-text",children:["\u0417\u0430\u043a\u0430\u0442: ",i.dusk]})]}),Object(j.jsx)("canvas",{id:"canvas",width:"180",height:"80"}),Object(j.jsx)("h3",{children:"\u0417\u0430\u0432\u0442\u0440\u0430"}),Object(j.jsxs)("div",{className:"card__container",children:[Object(j.jsx)("p",{children:i.temp}),Object(j.jsx)("img",{className:"card__image",src:i.icon,alt:i.weather}),Object(j.jsxs)("p",{className:"card__time-text",children:["\u0420\u0430\u0441\u0441\u0432\u0435\u0442: ",i.dawnTomorrow]}),Object(j.jsxs)("p",{className:"card__time-text",children:["\u0417\u0430\u043a\u0430\u0442: ",i.duskTomorrow]})]}),Object(j.jsx)("button",{type:"button",className:"button popup__close-btn",onClick:e}),Object(j.jsx)("canvas",{id:"canvas2",width:"180",height:"80"})]})})}var g=Object(s.b)((function(t){return{cards:t.items}}),(function(t){return{addCard:function(e){return t(u(e))}}}))((function(t){var e=t.addCard,n=t.isOpen,a=t.onClose,o=t.error,i=Object(c.useState)({title:""}),s=Object(r.a)(i,2),d=s[0],l=s[1];return Object(c.useEffect)((function(){n&&l({title:""})}),[n]),Object(j.jsx)("section",{className:"popup ".concat(n&&"popup_opened"),children:Object(j.jsxs)("div",{className:"popup__container",children:[Object(j.jsx)("h2",{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0433\u043e\u0440\u043e\u0434"}),Object(j.jsxs)("form",{onSubmit:function(t){var n;t.preventDefault(),(n=d.title,fetch("".concat(h,"/weather?q=").concat(n,"&appid=").concat(O,"&lang=ru&units=metric")).then(b)).then((function(t){var n={id:Object(p.a)(),title:t.name,temp:"".concat(Math.floor(t.main.temp),"\xb0C"),icon:"http://openweathermap.org/img/wn/".concat(t.weather[0].icon,".png"),coord:{lon:t.coord.lon,lat:t.coord.lat}};e(n),a()})).catch((function(){a(),o()}))},children:[Object(j.jsx)("input",{type:"text",required:!0,minLength:"3",maxLength:"40",value:d.title||"",onChange:function(t){l({title:t.target.value})},className:"form__input"}),Object(j.jsx)("button",{type:"submit",className:"button submit-btn"})]}),Object(j.jsx)("button",{type:"button",className:"button popup__close-btn",onClick:a})]})})}));var x=Object(s.b)(null,(function(t){return{removeCard:function(e){return t({type:l,payload:{id:e}})}}}))((function(t){var e=t.card,n=t.removeCard,c=t.onCardClick;return Object(j.jsxs)("div",{className:"card__container",children:[Object(j.jsxs)("li",{className:"card",onClick:function(){c(e)},children:[Object(j.jsx)("h2",{className:"card__text",children:e.title}),Object(j.jsx)("p",{children:e.temp}),Object(j.jsx)("img",{className:"card__image",src:e.icon,alt:e.weather})]}),Object(j.jsx)("button",{className:"\u041c\u043e\u0451 \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435"!==e.title?"button delete-btn":"button_inactive",type:"button",onClick:function(){return t=e.id,void n(t);var t}})]})})),w=(n(24),Object(s.b)((function(t){return{cards:t.items}}),(function(t){return{addCard:function(e){return t(u(e))}}}))((function(t){var e=t.cards,n=t.addCard,a=Object(c.useState)(null),o=Object(r.a)(a,2),i=o[0],s=o[1],d=Object(c.useState)(!1),l=Object(r.a)(d,2),u=l[0],w=l[1],v=Object(c.useState)(!1),_=Object(r.a)(v,2),C=_[0],N=_[1],y=Object(c.useState)(!1),M=Object(r.a)(y,2),k=M[0],I=M[1];function T(t){s(t)}function P(){w(!1),N(!1),I(!1),s(null)}return Object(c.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(t){var e,c;(e=t.coords.longitude,c=t.coords.latitude,fetch("".concat(h,"/weather?lat=").concat(c,"&lon=").concat(e,"&appid=").concat(O,"&lang=ru&units=metric")).then(b)).then((function(t){var e={id:Object(p.a)(),title:"\u041c\u043e\u0451 \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435",temp:"".concat(Math.floor(t.main.temp),"\xb0C"),icon:"http://openweathermap.org/img/wn/".concat(t.weather[0].icon,".png"),weather:t.weather[0].description,coord:{lon:t.coord.lon,lat:t.coord.lat}};n(e)})).catch((function(){w(!0)}))}))}),[n]),Object(j.jsxs)("div",{className:"page",children:[Object(j.jsx)("ul",{className:"cards__list",children:e.map((function(t){return Object(j.jsx)(x,{className:"card",card:t,onCardClick:T},t.id)}))}),Object(j.jsx)("button",{className:"button new-place-btn",onClick:function(){I(!0)}}),Object(j.jsx)(m,{isOpen:u,onClose:P}),Object(j.jsx)(f,{card:i,isOpen:C,onClose:P}),Object(j.jsx)(g,{isOpen:k,onClose:P,error:function(){w(!0)}})]})}))),v=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,27)).then((function(e){var n=e.getCLS,c=e.getFID,a=e.getFCP,o=e.getLCP,i=e.getTTFB;n(t),c(t),a(t),o(t),i(t)}))},_=n(12),C=n(11),N=n(5),y={items:[]};var M=Object(_.a)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case d:return Object(N.a)(Object(N.a)({},t),{},{items:[].concat(Object(C.a)(t.items),[e.payload])});case l:return Object(N.a)(Object(N.a)({},t),{},{items:t.items.filter((function(t){return t.id!==e.payload.id}))});default:return t}}));i.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(s.a,{store:M,children:Object(j.jsx)(w,{})})}),document.getElementById("root")),v()}},[[25,1,2]]]);
//# sourceMappingURL=main.f1bcfdd7.chunk.js.map